import { Camera, useCameraDevices } from 'react-native-vision-camera';

// Main App Component
const ProfessionalCamera = () => {
  const devices = useCameraDevices();
  const [cameraPosition, setCameraPosition] = useState('back');
  const device = devices[cameraPosition];

  // 1. Photo Capture Function
  const takePhoto = async () => {
    const photo = await camera.current.takePhoto();
    console.log(photo.path);
  };

  // 2. Video Recording Function
  const startRecording = () => {
    camera.current.startRecording({
      onRecordingFinished: (video) => console.log(video),
      onRecordingError: (error) => console.error(error),
    });
  };

  if (device == null) return <LoadingView />;

  return (
    <View style={{ flex: 1 }}>
      <Camera
        ref={camera}
        style={StyleSheet.absoluteFill}
        device={device}
        isActive={true}
        video={true}
        photo={true}
      />
      
      {/* UI Elements: Filters, Flip Camera, Record Buttons */}
      <View style={styles.controls}>
         <Button title="Flip" onPress={() => setCameraPosition(cameraPosition === 'back' ? 'front' : 'back')} />
         <Button title="Capture" onPress={takePhoto} />
         <Button title="Go Live" onPress={startLiveStream} />
      </View>
    </View>
  );
};
